<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

<div th:replace="layout/base :: nav-bar"></div>

<h2>Community Posts</h2>

<a th:href="@{/ui/post/create}" sec:authorize="isAuthenticated()"
   style="display:inline-block; margin-top:15px; padding:8px 12px; background:#2c7; color:white; border-radius:4px;">
  Create Post
</a>

<br/><br/>

<div th:each="post : ${posts}" style="border:1px solid #ddd; padding:15px; margin-bottom:10px; border-radius:6px;">
  <h4 th:text="${post.title}">Post Title</h4>
  <p th:text="${post.content}">Post content...</p>
  <p>Average Rating: <span th:text="${post.averageRating}">0</span></p>

  <form th:action="@{/ui/post/{id}/rate(id=${post.id})}" method="post"
        sec:authorize="isAuthenticated()" style="margin-top:10px;">

    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <label>
      Rate this post (1â€“5):
      <input type="number" name="rating" min="1" max="5" required>
    </label>
    <button type="submit">Rate</button>
  </form>
</div>

</body>
</html>
